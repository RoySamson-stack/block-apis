
# ================================
# FILE: docker-compose.dev.yml (ROOT DIRECTORY)
# For development with hot reload
# ================================
version: '3.8'

services:
  api:
    build:
      context: .
      dockerfile: apps/api/Dockerfile.dev
    container_name: blockchain_api_dev
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=development
      - DATABASE_URL=postgresql://riot:riot9334@postgres:5432/blockchain_api
      - REDIS_URL=redis://redis:6379
      - BITCOIN_RPC_URL=http://bitcoin-node:8332
      - BITCOIN_RPC_USER=bitcoinrpc
      - BITCOIN_RPC_PASSWORD=changeme123
      - ETHEREUM_RPC_URL=http://ethereum-node:8545
      - ETHEREUM_WS_URL=ws://ethereum-node:8546
    volumes:
      - ./apps/api:/app
      - /app/node_modules
      - /app/.next
    depends_on:
      postgres:
        condition: service_healthy
      redis:
        condition: service_healthy
    networks:
      - blockchain_network
    command: npm run dev

networks:
  blockchain_network:
    external: true